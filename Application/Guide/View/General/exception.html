{include Public/header.html}
<body class="wy-body-for-nav" role="document" xmlns="http://www.w3.org/1999/html">
<div id="nav2">
    <a href="#" id="openToc">
        <img src="data:image/jpg;base64,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" title="切换目录" alt="切换目录" />
    </a>
</div>

<div class="wy-grid-for-nav">
    {include Public/nav.html}

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="../index.html">ppf</a>
        </nav>



        <div class="wy-nav-content">
            <div class="rst-content">
                <div role="navigation" aria-label="breadcrumbs navigation">
                    <ul class="wy-breadcrumbs">
                        <li><a href="/" target="_blank">ppf 中国</a> &raquo; </li>
                        <li><a href="/Guide/Index/index">文档首页</a> &raquo; </li>
                        <li><a href="/Guide/General/index">常规主题</a> &raquo; </li>

                        <li>异常处理</li>
                        <li class="wy-breadcrumbs-aside">

                        </li>
                        <div style="float:right;">
                            <div style="text-decoration:underline;color:blue;margin-left:5px;cursor:pointer;" id="closeMe">
                                <img title="目录" alt="toc" src="data:image/gif;base64,R0lGODlhFAAUAJEAAAAAADMzM////wAAACH5BAUUAAIALAAAAAAUABQAAAImlI+py+0PU5gRBRDM3DxbWoXis42X13USOLauUIqnlsaH/eY6UwAAOw==" />
                            </div>
                        </div>
                    </ul>
                    <hr/>
                </div>
                <div role="main" class="document">

                    <div class="section" id="codeigniter">
                        <h1>异常处理<a class="headerlink" href="#codeigniter" title="永久链接至标题">¶</a></h1>
                        <h2>为何使用异常？</h2>
                        <p>现在主流的php程序中，经常都是使用异常来进行代码的判断以及处理，所以ppf中也封装了异常的模块来供大家使用和学习</p>
                        <h2>ppf中如何抛出异常？</h2>
                        <p>以下给出demo，如何在控制器中抛出异常以及捕获异常</p>

                        <pre>
                            <code>
&lt?php
/**
 * @desc 测试模块
 *
 */
class ExceptionController extends Controller {
    /**
     * @desc 抛出异常
     */
    public function indexAction() {
        $this->load('Common/Function');
        $test = 1;
        if($test == 1) {
            throw new FrameException("", ErrorCode::test);
        }
        $this->view->assign("result","hello world!");
        //$this->view->assign('signArr',$signArr);
        $this->view->show();
    }

}
?&gt
                            </code>
                        </pre>
                        <p>代码中，我们可以主动抛出<span style="color: red" >FrameException</span>这一异常，并且可以定义异常的error_code以及对应的code_name</p>
                        <h2>FrameException如何编写？</h2>
                        <p>在Library/Exception目录下创建FrameException文件,编写如下代码</p>
                        <pre><code>
&lt?php

/**
 * @desc 框架异常类
 * 通过 throw new FrameException($message,$code)来使用以及捕获异常
 */
class FrameException extends Exception {
	private $extra_data	= null;

	public function __construct($message = '', $code = 0, $extra_data = null) {
		if(!$message) {
			require_once(PPF_PATH."/Library/Common/ErrorCode.php");
			$errorCode = new ErrorCode();
			$message = $errorCode->get($code);
        }
        parent::__construct($message, $code);
        $this->extra_data	= $extra_data;
    }

    public function getExtraData() {
        return $this->extra_data;
    }
}
?&gt
                        </code></pre>
                        <p>然后你在页面上可以看到异常信息展示如下：</p>
                            <img src="/Public/Image/exception.jpg"/>
                        <br>
                        <br>
                        <h2>异常是如何捕获的，原理是什么？</h2>
                        <p>我们可以在Library/Sys/Controller.php文件中找到原因，以及定制错误界面的模版</p>
                    <pre><code>
&lt?php
private $loadException  = "FrameException";
private $hasException   = false;
protected $view;
public function __CONSTRUCT()
{

    //默认导入TestException异常类
    $this->load('Exception/FrameException');
    $this->load('Common/ErrorCode');
    //设置异常处理函数
    restore_exception_handler();
    set_exception_handler(array($this,"setExceptionHandler"));

    $this->view = new View();
}
public function setExceptionHandler(Throwable $e = null) {
    $this->hasException = true;
    $this->ShowErrorHtml($e);

}

/**
* @desc 显示错误信息
*/
private function ShowErrorHtml(Throwable $e = null) {
    $html = &lt&lt&lt HTML
    &ltpre class="alert alert-danger" style="color:#a94442;background-color: #f2dede;border-color: #ebccd1;font-size: 15px"&gt
                        &lth2 class="error-danger" style="text-align:center">出错了&lt/h2&gt
    错误描述: {\$e->getMessage()}&ltbr&gt
    文件位置: {\$e->getFile()}第{\$e->getLine()}行&ltbr&gt
    信息栈:&ltbr&gt&ltbr&gt&ltdiv style="padding-left: 72px"&gt{\$e->getTraceAsString()}&lt/div&gt
    HTML;
    echo $html;die;
}
?&gt
                    </code></pre>
                        <p>具体我们可以百度谷歌 <a href="http://www.w3school.com.cn/php/func_error_set_error_handler.asp"><span style="color: red">set_exception_handler</span></a> 的用法</p>
                    </div>


                </div>
                {include Public/footer.html}
            </div>
        </div>

    </section>

</div>
{include Public/common_js.html}
</body>
<script>
    hljs.initHighlightingOnLoad();
</script>
</html>